package com.cvg.msvc.gateway;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.cors.reactive.CorsWebFilter;
import org.springframework.web.reactive.config.CorsRegistry;
import org.springframework.web.reactive.config.WebFluxConfigurer;

@Configuration
public class CorsConfiguration implements WebFluxConfigurer {
	
	 public void addCorsMappings(CorsRegistry registry) {
	        registry.addMapping("/**")
	                .allowCredentials(true)
	                .allowedOrigins("*")
	                .allowedHeaders("*")
	                .allowedMethods("*");
	    }

	    @Bean
	    public CorsWebFilter corsWebFilter() {
	        CORSConfiguration corsConfiguration = new CORSConfiguration();
	        corsConfiguration.setAllowCredentials(true);
	        corsConfiguration.addAllowedHeader("*");
	        corsConfiguration.addAllowedMethod("*");
	        corsConfiguration.addAllowedOrigin("*");
	        corsConfiguration.addExposedHeader(HttpHeaders.SET_COOKIE);
	        UrlBasedCorsConfigurationSource corsConfigurationSource = new UrlBasedCorsConfigurationSource();
	        corsConfigurationSource.registerCorsConfiguration("/**", corsConfiguration);
	        return new CorsWebFilter(corsConfigurationSource);
	    }

}
